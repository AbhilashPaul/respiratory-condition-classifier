Training Dataset Size: 10607
Validation Dataset Size: 3030
Testing Dataset Size: 1516
Class Names: ['covid19', 'normal', 'viral pneumonia']
Training Set Class Distribution:
normal: 7134
covid19: 2531
viral pneumonia: 942

Validation Set Class Distribution:
viral pneumonia: 269
normal: 2038
covid19: 723

Test Set Class Distribution:
normal: 1020
covid19: 362
viral pneumonia: 134
Class Weights: tensor([1.3969, 0.4956, 3.7534])
Epoch 1/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 1.4790 | train Accuracy: 0.6836
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.5467 | val Accuracy: 0.8752
Validation loss decreased from inf to 0.5467. Saving model...


Epoch 2/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.7814 | train Accuracy: 0.7614
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.4325 | val Accuracy: 0.8475
Validation loss decreased from 0.5467 to 0.4325. Saving model...


Epoch 3/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6417 | train Accuracy: 0.8127
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.4242 | val Accuracy: 0.8525
Validation loss decreased from 0.4325 to 0.4242. Saving model...


Epoch 4/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6635 | train Accuracy: 0.8261
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3919 | val Accuracy: 0.8832
Validation loss decreased from 0.4242 to 0.3919. Saving model...


Epoch 5/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6282 | train Accuracy: 0.8394
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.7517 | val Accuracy: 0.8766


Epoch 6/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6024 | train Accuracy: 0.8387
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3475 | val Accuracy: 0.8901
Validation loss decreased from 0.3919 to 0.3475. Saving model...


Epoch 7/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6284 | train Accuracy: 0.8489
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.4513 | val Accuracy: 0.8901


Epoch 8/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6751 | train Accuracy: 0.8419
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.4478 | val Accuracy: 0.8878


Epoch 9/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.6655 | train Accuracy: 0.8509
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.4394 | val Accuracy: 0.8878


Epoch 10/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.5429 | train Accuracy: 0.8720
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3343 | val Accuracy: 0.8983
Validation loss decreased from 0.3475 to 0.3343. Saving model...


Epoch 11/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.5116 | train Accuracy: 0.8790
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3546 | val Accuracy: 0.8934


Epoch 12/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.5130 | train Accuracy: 0.8810
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3202 | val Accuracy: 0.8974
Validation loss decreased from 0.3343 to 0.3202. Saving model...


Epoch 13/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4699 | train Accuracy: 0.8786
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2889 | val Accuracy: 0.8970
Validation loss decreased from 0.3202 to 0.2889. Saving model...


Epoch 14/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4349 | train Accuracy: 0.8806
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2844 | val Accuracy: 0.9000
Validation loss decreased from 0.2889 to 0.2844. Saving model...


Epoch 15/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4395 | train Accuracy: 0.8762
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2715 | val Accuracy: 0.8980
Validation loss decreased from 0.2844 to 0.2715. Saving model...


Epoch 16/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4269 | train Accuracy: 0.8843
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2913 | val Accuracy: 0.8987


Epoch 17/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4308 | train Accuracy: 0.8810
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2894 | val Accuracy: 0.8950


Epoch 18/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4312 | train Accuracy: 0.8787
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2557 | val Accuracy: 0.9003
Validation loss decreased from 0.2715 to 0.2557. Saving model...


Epoch 19/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4278 | train Accuracy: 0.8749
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2563 | val Accuracy: 0.8924


Epoch 20/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3845 | train Accuracy: 0.8841
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2494 | val Accuracy: 0.9092
Validation loss decreased from 0.2557 to 0.2494. Saving model...


Epoch 21/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3765 | train Accuracy: 0.8844
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2526 | val Accuracy: 0.9036


Epoch 22/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3743 | train Accuracy: 0.8831
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2350 | val Accuracy: 0.8941
Validation loss decreased from 0.2494 to 0.2350. Saving model...


Epoch 23/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3504 | train Accuracy: 0.8800
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2568 | val Accuracy: 0.8832


Epoch 24/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3462 | train Accuracy: 0.8814
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2335 | val Accuracy: 0.9089
Validation loss decreased from 0.2350 to 0.2335. Saving model...


Epoch 25/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3442 | train Accuracy: 0.8812
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2053 | val Accuracy: 0.9063
Validation loss decreased from 0.2335 to 0.2053. Saving model...


Epoch 26/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3202 | train Accuracy: 0.8853
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2207 | val Accuracy: 0.9106


Epoch 27/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3143 | train Accuracy: 0.8931
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2319 | val Accuracy: 0.8990


Epoch 28/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3081 | train Accuracy: 0.8875
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2185 | val Accuracy: 0.8964


Epoch 29/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2973 | train Accuracy: 0.8914
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2144 | val Accuracy: 0.9089


Epoch 30/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2890 | train Accuracy: 0.8934
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2150 | val Accuracy: 0.9033


Training complete in 175m 10s
Best val loss: 0.2053
Model saved to output/best_model.pth
Unique classes in y_true_list: [0 1 2]
Unique classes in y_pred_list: [0 1 2]
Accuracy: 0.8971
                 precision    recall  f1-score   support

        covid19       0.78      0.88      0.83       362
         normal       0.95      0.90      0.92      1020
viral pneumonia       0.87      0.96      0.91       134

       accuracy                           0.90      1516
      macro avg       0.87      0.91      0.89      1516
   weighted avg       0.90      0.90      0.90      1516

