Training Dataset Size: 10607
Validation Dataset Size: 3030
Testing Dataset Size: 1516
Class Names: ['covid19', 'normal', 'viral pneumonia']
Training Set Class Distribution:
covid19: 2531
normal: 7134
viral pneumonia: 942

Validation Set Class Distribution:
viral pneumonia: 269
normal: 2038
covid19: 723

Test Set Class Distribution:
normal: 1020
covid19: 362
viral pneumonia: 134
Class Weights: tensor([1.3969, 0.4956, 3.7534])
Epoch 1/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4768 | train Accuracy: 0.7657
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3360 | val Accuracy: 0.8634
Validation loss decreased from inf to 0.3360. Saving model...


Epoch 2/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.3178 | train Accuracy: 0.8526
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2802 | val Accuracy: 0.8578
Validation loss decreased from 0.3360 to 0.2802. Saving model...


Epoch 3/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2708 | train Accuracy: 0.8756
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1604 | val Accuracy: 0.9271
Validation loss decreased from 0.2802 to 0.1604. Saving model...


Epoch 4/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2542 | train Accuracy: 0.8802
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1753 | val Accuracy: 0.9317


Epoch 5/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2345 | train Accuracy: 0.9010
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1892 | val Accuracy: 0.8888


Epoch 6/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2091 | train Accuracy: 0.9097
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1283 | val Accuracy: 0.9492
Validation loss decreased from 0.1604 to 0.1283. Saving model...


Epoch 7/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2007 | train Accuracy: 0.9080
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1395 | val Accuracy: 0.9591


Epoch 8/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.1791 | train Accuracy: 0.9183
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1876 | val Accuracy: 0.8779


Epoch 9/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.1664 | train Accuracy: 0.9244
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.1612 | val Accuracy: 0.9211


Epoch 10/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.1099 | train Accuracy: 0.9507
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0830 | val Accuracy: 0.9630
Validation loss decreased from 0.1283 to 0.0830. Saving model...


Epoch 11/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0978 | train Accuracy: 0.9587
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0831 | val Accuracy: 0.9703


Epoch 12/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0898 | train Accuracy: 0.9603
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0781 | val Accuracy: 0.9723
Validation loss decreased from 0.0830 to 0.0781. Saving model...


Epoch 13/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0853 | train Accuracy: 0.9609
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0783 | val Accuracy: 0.9604


Epoch 14/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0759 | train Accuracy: 0.9646
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0617 | val Accuracy: 0.9696
Validation loss decreased from 0.0781 to 0.0617. Saving model...


Epoch 15/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0738 | train Accuracy: 0.9666
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0651 | val Accuracy: 0.9726


Epoch 16/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0679 | train Accuracy: 0.9689
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0615 | val Accuracy: 0.9776
Validation loss decreased from 0.0617 to 0.0615. Saving model...


Epoch 17/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0676 | train Accuracy: 0.9717
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0680 | val Accuracy: 0.9710


Epoch 18/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0624 | train Accuracy: 0.9714
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0568 | val Accuracy: 0.9782
Validation loss decreased from 0.0615 to 0.0568. Saving model...


Epoch 19/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0628 | train Accuracy: 0.9729
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0710 | val Accuracy: 0.9772


Epoch 20/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0617 | train Accuracy: 0.9725
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0642 | val Accuracy: 0.9802


Epoch 21/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0593 | train Accuracy: 0.9751
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0573 | val Accuracy: 0.9789


Epoch 22/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0512 | train Accuracy: 0.9768
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0604 | val Accuracy: 0.9736


Epoch 23/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0542 | train Accuracy: 0.9778
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0521 | val Accuracy: 0.9782
Validation loss decreased from 0.0568 to 0.0521. Saving model...


Epoch 24/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0453 | train Accuracy: 0.9799
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0560 | val Accuracy: 0.9795


Epoch 25/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0473 | train Accuracy: 0.9777
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0595 | val Accuracy: 0.9762


Epoch 26/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0467 | train Accuracy: 0.9780
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0526 | val Accuracy: 0.9739


Epoch 27/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0464 | train Accuracy: 0.9804
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0522 | val Accuracy: 0.9809


Epoch 28/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0479 | train Accuracy: 0.9785
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0553 | val Accuracy: 0.9746


Epoch 29/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0424 | train Accuracy: 0.9811
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0595 | val Accuracy: 0.9779


Epoch 30/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0440 | train Accuracy: 0.9793
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0555 | val Accuracy: 0.9812


Training complete in 181m 32s
Best val loss: 0.0521
Model saved to output/best_model.pth
Unique classes in y_true_list: [0 1 2]
Unique classes in y_pred_list: [0 1 2]
Accuracy: 0.9690
                 precision    recall  f1-score   support

        covid19       0.93      0.98      0.95       362
         normal       0.99      0.97      0.98      1020
viral pneumonia       0.92      0.98      0.95       134

       accuracy                           0.97      1516
      macro avg       0.95      0.97      0.96      1516
   weighted avg       0.97      0.97      0.97      1516

