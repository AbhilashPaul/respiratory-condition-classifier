Training Dataset Size: 10607
Validation Dataset Size: 3030
Testing Dataset Size: 1516
Class Names: ['covid19', 'normal', 'viral pneumonia']
Training Set Class Distribution:
covid19: 2531
normal: 7134
viral pneumonia: 942

Validation Set Class Distribution:
viral pneumonia: 269
normal: 2038
covid19: 723

Test Set Class Distribution:
normal: 1020
covid19: 362
viral pneumonia: 134
Class Weights: tensor([1.3969, 0.4956, 3.7534])
Epoch 1/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.4225 | train Accuracy: 0.8044
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2182 | val Accuracy: 0.8990
Validation loss decreased from inf to 0.2182. Saving model...


Epoch 2/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2607 | train Accuracy: 0.8838
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.3644 | val Accuracy: 0.7488


Epoch 3/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2354 | train Accuracy: 0.8985
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2584 | val Accuracy: 0.9026


Epoch 4/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.2073 | train Accuracy: 0.9092
Learning Rate: 0.001000
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.2205 | val Accuracy: 0.9485


Epoch 5/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.1144 | train Accuracy: 0.9509
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0868 | val Accuracy: 0.9647
Validation loss decreased from 0.2182 to 0.0868. Saving model...


Epoch 6/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0984 | train Accuracy: 0.9574
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0720 | val Accuracy: 0.9696
Validation loss decreased from 0.0868 to 0.0720. Saving model...


Epoch 7/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0777 | train Accuracy: 0.9672
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0884 | val Accuracy: 0.9759


Epoch 8/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0709 | train Accuracy: 0.9687
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0724 | val Accuracy: 0.9766


Epoch 9/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0664 | train Accuracy: 0.9710
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0666 | val Accuracy: 0.9716
Validation loss decreased from 0.0720 to 0.0666. Saving model...


Epoch 10/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0552 | train Accuracy: 0.9763
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0593 | val Accuracy: 0.9729
Validation loss decreased from 0.0666 to 0.0593. Saving model...


Epoch 11/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0566 | train Accuracy: 0.9747
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0527 | val Accuracy: 0.9795
Validation loss decreased from 0.0593 to 0.0527. Saving model...


Epoch 12/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0503 | train Accuracy: 0.9789
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0668 | val Accuracy: 0.9653


Epoch 13/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0533 | train Accuracy: 0.9761
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0544 | val Accuracy: 0.9729


Epoch 14/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0413 | train Accuracy: 0.9828
Learning Rate: 0.000100
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0567 | val Accuracy: 0.9802


Epoch 15/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0378 | train Accuracy: 0.9845
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0497 | val Accuracy: 0.9828
Validation loss decreased from 0.0527 to 0.0497. Saving model...


Epoch 16/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0298 | train Accuracy: 0.9866
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0438 | val Accuracy: 0.9802
Validation loss decreased from 0.0497 to 0.0438. Saving model...


Epoch 17/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0290 | train Accuracy: 0.9861
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0496 | val Accuracy: 0.9818


Epoch 18/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0286 | train Accuracy: 0.9878
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0473 | val Accuracy: 0.9842


Epoch 19/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0256 | train Accuracy: 0.9892
Learning Rate: 0.000010
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0445 | val Accuracy: 0.9858


Epoch 20/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0258 | train Accuracy: 0.9893
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0454 | val Accuracy: 0.9851


Epoch 21/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0244 | train Accuracy: 0.9894
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0529 | val Accuracy: 0.9855


Epoch 22/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0248 | train Accuracy: 0.9891
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0483 | val Accuracy: 0.9832


Epoch 23/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0244 | train Accuracy: 0.9904
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0418 | val Accuracy: 0.9875
Validation loss decreased from 0.0438 to 0.0418. Saving model...


Epoch 24/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0271 | train Accuracy: 0.9890
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0460 | val Accuracy: 0.9838


Epoch 25/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0244 | train Accuracy: 0.9904
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0439 | val Accuracy: 0.9858


Epoch 26/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0238 | train Accuracy: 0.9893
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0560 | val Accuracy: 0.9828


Epoch 27/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0221 | train Accuracy: 0.9904
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0455 | val Accuracy: 0.9845


Epoch 28/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0254 | train Accuracy: 0.9885
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0518 | val Accuracy: 0.9838


Epoch 29/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0255 | train Accuracy: 0.9887
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0486 | val Accuracy: 0.9855


Epoch 30/30

train:   0%|          | 0/531 [00:00<?, ?it/s]
train Loss: 0.0216 | train Accuracy: 0.9904
Learning Rate: 0.000001
val:   0%|          | 0/152 [00:00<?, ?it/s]
val Loss: 0.0512 | val Accuracy: 0.9802


Training complete in 184m 25s
Best val loss: 0.0418
Model saved to output/best_model.pth
Unique classes in y_true_list: [0 1 2]
Unique classes in y_pred_list: [0 1 2]
Accuracy: 0.9822
                 precision    recall  f1-score   support

        covid19       0.97      0.97      0.97       362
         normal       0.99      0.99      0.99      1020
viral pneumonia       0.96      0.99      0.97       134

       accuracy                           0.98      1516
      macro avg       0.97      0.98      0.98      1516
   weighted avg       0.98      0.98      0.98      1516

